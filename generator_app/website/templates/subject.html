<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Wyb贸r Podmiotu</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; text-align: center; margin-top: 20px; padding-bottom: 50px; }
        .home-icon { position: absolute; left: 15px; top: 15px; font-size: 30px; text-decoration: none; }

        /* Kontenery sekcji */
        .section-container {
            margin: 20px auto;
            max-width: 800px;
            padding: 10px;
            /* Domylnie ukryte, chyba 偶e maj klas visible */
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease-in;
        }

        .section-container.visible {
            display: block;
            opacity: 1;
        }

        /* Styl przycisk贸w */
        .btn {
            background-color: #f8f9fa;
            border: 2px solid #333;
            color: #333;
            padding: 15px 30px;
            font-size: 16px;
            margin: 10px;
            cursor: pointer;
            border-radius: 8px;
            min-width: 200px;
            transition: all 0.3s;
        }

        .btn:hover { background-color: #e2e6ea; transform: translateY(-2px); }

        /* Styl wybranego przycisku (aktywnego) */
        .btn.selected {
            background-color: #333;
            color: #fff;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        h2 { border-bottom: 1px solid #ccc; padding-bottom: 10px; margin-bottom: 20px; color: #555; }
    </style>
    <script>
        // Funkcja obsugujca Krok 1 (Forma)
        function handleStep1(type, btn) {
            // 1. Zapisz warto
            document.getElementById('noun_phrase_input').value = type === 'noun_phrase' ? 'true' : 'false';

            // 2. Obsuga wizualna przycisk贸w (podwietlenie)
            resetButtons('step-1-btns');
            btn.classList.add('selected');

            // 3. Ukryj wszystkie sekcje pod spodem (reset widoku)
            hideAllNextSteps();

            // 4. Poka偶 odpowiedni Krok 2
            if (type === 'pronoun') {
                document.getElementById('step-2-pronoun').classList.add('visible');
            } else {
                document.getElementById('step-2-noun').classList.add('visible');
            }
        }

        // Funkcja obsugujca Krok 2 (Liczba)
        function handleStep2(number, btn, context) {
            // 1. Zapisz warto
            document.getElementById('number_input').value = number;

            // 2. Obsuga wizualna przycisk贸w
            // context to ID kontenera przycisk贸w (np. 'btns-pronoun-number')
            resetButtons(context);
            btn.classList.add('selected');

            // 3. Ukryj wszystkie sekcje Kroku 3
            document.getElementById('step-3-pronoun-sg').classList.remove('visible');
            document.getElementById('step-3-pronoun-pl').classList.remove('visible');
            document.getElementById('step-3-noun-sg').classList.remove('visible');
            document.getElementById('step-3-noun-pl').classList.remove('visible');

            // 4. Poka偶 odpowiedni Krok 3 na podstawie poprzednich wybor贸w
            const isNounPhrase = document.getElementById('noun_phrase_input').value === 'true';

            let targetId = '';
            if (!isNounPhrase && number === 'singular') targetId = 'step-3-pronoun-sg';
            if (!isNounPhrase && number === 'plural') targetId = 'step-3-pronoun-pl';
            if (isNounPhrase && number === 'singular') targetId = 'step-3-noun-sg';
            if (isNounPhrase && number === 'plural') targetId = 'step-3-noun-pl';

            if (targetId) {
                document.getElementById(targetId).classList.add('visible');
                // Opcjonalnie: Scroll do nowej sekcji
                document.getElementById(targetId).scrollIntoView({behavior: "smooth", block: "start"});
            }
        }

        // Helpery
        function resetButtons(containerId) {
            const container = document.getElementById(containerId);
            const buttons = container.getElementsByClassName('btn');
            for (let b of buttons) {
                b.classList.remove('selected');
            }
        }

        function hideAllNextSteps() {
            // Ukryj wszystko od kroku 2 w d贸
            const sections = document.querySelectorAll('.sub-step');
            sections.forEach(s => s.classList.remove('visible'));
        }
    </script>
</head>
<body>
    <a href="{{ url_for('views.restart') }}" class="home-icon" title="Restart"></a>

    <h1>Wyb贸r Podmiotu</h1>

    <form action="{{ url_for('views.subject') }}" method="POST">
        <input type="hidden" id="noun_phrase_input" name="noun_phrase" value="">
        <input type="hidden" id="number_input" name="number" value="">

        <div class="section-container visible">
            <h2>1. Wybierz form podmiotu</h2>
            <div id="step-1-btns">
                <button type="button" class="btn" onclick="handleStep1('pronoun', this)">Zaimek</button>
                <button type="button" class="btn" onclick="handleStep1('noun_phrase', this)">Fraza Rzeczownikowa</button>
            </div>
        </div>

        <div id="step-2-pronoun" class="section-container sub-step">
            <h2>2. Wybierz liczb (Zaimek)</h2>
            <div id="btns-pronoun-number">
                <button type="button" class="btn" onclick="handleStep2('singular', this, 'btns-pronoun-number')">Liczba Pojedyncza</button>
                <button type="button" class="btn" onclick="handleStep2('plural', this, 'btns-pronoun-number')">Liczba Mnoga</button>
            </div>
        </div>

        <div id="step-2-noun" class="section-container sub-step">
            <h2>2. Wybierz liczb (Fraza)</h2>
            <div id="btns-noun-number">
                <button type="button" class="btn" onclick="handleStep2('singular', this, 'btns-noun-number')">Liczba Pojedyncza</button>
                <button type="button" class="btn" onclick="handleStep2('plural', this, 'btns-noun-number')">Liczba Mnoga</button>
            </div>
        </div>

        <div id="step-3-pronoun-sg" class="section-container sub-step">
            <h2>3. Zatwierd藕 rodzaj zaimka</h2>
            <button type="submit" class="btn" name="pronoun_or_article" value="personal">Osobowy (I, you...)</button>
            <button type="submit" class="btn" name="pronoun_or_article" value="demonstrative">Wskazujcy (this...)</button>
            <button type="submit" class="btn" name="pronoun_or_article" value="possessive">Dzier偶awczy (mine...)</button>
            <button type="submit" class="btn" name="pronoun_or_article" value="indefinite">Nieokrelony (someone...)</button>
        </div>

        <div id="step-3-pronoun-pl" class="section-container sub-step">
            <h2>3. Zatwierd藕 rodzaj zaimka</h2>
            <button type="submit" class="btn" name="pronoun_or_article" value="personal">Osobowy (we, they...)</button>
            <button type="submit" class="btn" name="pronoun_or_article" value="demonstrative">Wskazujcy (these...)</button>
            <button type="submit" class="btn" name="pronoun_or_article" value="possessive">Dzier偶awczy (ours...)</button>
        </div>

        <div id="step-3-noun-sg" class="section-container sub-step">
            <h2>3. Zatwierd藕 okrelenie</h2>
            <button type="submit" class="btn" name="pronoun_or_article" value="possessive_det">Z okr. dzier偶awczym (my...)</button>
            <button type="submit" class="btn" name="pronoun_or_article" value="demonstrative_det">Z okr. wskazujcym (this...)</button>
            <button type="submit" class="btn" name="pronoun_or_article" value="article">Z rodzajnikiem (the...)</button>
        </div>

        <div id="step-3-noun-pl" class="section-container sub-step">
            <h2>3. Zatwierd藕 okrelenie</h2>
            <button type="submit" class="btn" name="pronoun_or_article" value="possessive_det">Z okr. dzier偶awczym (my...)</button>
            <button type="submit" class="btn" name="pronoun_or_article" value="demonstrative_det">Z okr. wskazujcym (these...)</button>
            <button type="submit" class="btn" name="pronoun_or_article" value="article">Z rodzajnikiem (the...)</button>
        </div>

    </form>
</body>
</html>